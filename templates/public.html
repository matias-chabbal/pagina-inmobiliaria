<!DOCTYPE html>
<html>
<head>
    <title>Pesasi-Migliori Propiedades</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/common.css">

    
</head>
<body>

    <header class="header">
        <img src="/static/images/logo-pesasi-migliori.png" alt="Pesasi-Migliori" class="brand-logo" >
    </header>
    
    <nav class="nav-container">
        <div class="nav-content">
            <button class="menu-button" onclick="toggleMenu()">☰</button>
            <div class="nav-links" id="navLinks">
                <a href="/" class="nav-link active">Propiedades</a>
                <a href="/sobre-nosotros" class="nav-link">Sobre Nosotros</a>
                <a href="#" class="nav-link" id="contactBtn">Como Encontrarnos</a>
                <a href="#" class="nav-link" id="tasacionBtn">Tasación</a>
            </div>
        </div>
    </nav>
   
            <!-- acá va el contenido específico de cada página -->

         <div class="page-overlay">
            <div class="page-container">
            <h2 class="section-title">Propiedades Disponibles</h2>
            <div class="container">
                <form class="filter-form" method="get" action="">
    <div class="filter-row">
        <select name="tipo" class="filter-input">
            <option value="">Tipo de propiedad</option>
            <option value="Casa" {% if request.query_params.get('tipo') == "Casa" %}selected{% endif %}>Casa</option>
            <option value="Departamento" {% if request.query_params.get('tipo') == "Departamento" %}selected{% endif %}>Departamento</option>
            <option value="Terreno" {% if request.query_params.get('tipo') == "Terreno" %}selected{% endif %}>Terreno</option>
        </select>
        <select name="operacion" class="filter-input">
            <option value="">Operación</option>
            <option value="venta" {% if request.query_params.get('operacion') == "venta" %}selected{% endif %}>Venta</option>
            <option value="alquiler" {% if request.query_params.get('operacion') == "alquiler" %}selected{% endif %}>Alquiler</option>
        </select>
        <input type="number" name="precio_min" class="filter-input" placeholder="Precio mínimo" value="{{ request.query_params.get('precio_min', '') }}">
        <input type="number" name="precio_max" class="filter-input" placeholder="Precio máximo" value="{{ request.query_params.get('precio_max', '') }}">
        <input type="text" name="ubicacion" class="filter-input" placeholder="Ubicación" value="{{ request.query_params.get('ubicacion', '') }}">
        <button type="submit" class="filter-btn">Filtrar</button>
        <a href="/" class="filter-clear-btn">Limpiar filtro</a>
    </div>
</form>
        <div class="propiedades-grid">
            {% for p in propiedades %}
                <div class="propiedad-card">
                    <div class="imagen-container">
                        {% if p.imagenes %}
                            <img class="propiedad-imagen" src="{{ p.imagenes[0].url }}" alt="{{ p.titulo }}">
                        {% else %}
                            <img class="propiedad-imagen" src="/static/images/default-property.jpg" alt="Sin imagen">
                        {% endif %}
                    </div>
                    <div class="propiedad-info">
                        <h3 class="propiedad-titulo">{{ p.titulo }}</h3>
                        <div class="propiedad-tipo">{{ p.tipo }}</div>
                        <div class="propiedad-tipo">$ {{ p.precio }}</div>
                        <p class="propiedad-descripcion">{{ p.ubicacion }}</p>
                        <span class="operacion">({{ p.operacion | capitalize }})</span>
                        <div class="botones-container">
                            <a href="/propiedad/{{ p.id }}" class="btn btn-detalles">Ver Detalles</a>
                            <a href="https://wa.me/3543511948?text=Hola, me interesa la propiedad: {{ p.titulo|urlencode }} ({{ request.base_url }}propiedad/{{ p.id }})" 
                               target="_blank" 
                               class="btn btn-whatsapp">
                                Consultar
                            </a>
                        </div>
                    </div>
                </div>
            {% else %}
                <p>No hay propiedades para mostrar.</p>
            {% endfor %}
        </div>
    </div>
        </div>
</div>
    
    <a href="#" id="whatsappBtn" class="whatsapp-float floating-whatsapp" title="Enviar consulta por WhatsApp">
        <img src="/static/images/whatsapp-logo.png" alt="WhatsApp" class="whatsapp-logo">
        
    </a>

    <footer class="footer">
        <p>&copy; 2023 Pesasi-Migliori. Todos los derechos reservados.</p>
    </footer>

    <div id="contactModal" class="contact-modal">
    <div class="contact-modal-content">
        <span class="close-modal" id="closeContactModal">&times;</span>
        <h2>Contacto</h2>
        <p>
            <strong>Dirección:</strong>
            <a href="https://maps.google.com/?q=Av.+San+Martín+123,+Unquillo,+Córdoba" target="_blank" class="contact-link">
                Av. San Martín 123, Unquillo, Córdoba
            </a>
        </p>
        <p>
            <strong>Teléfono:</strong>
            <a href="tel:3543511948" class="contact-link">
                (03543) 123456
            </a>
        </p>
        <p>
            <strong>Email:</strong>
            <a href="mailto:info@pesasimigliori.com.ar" class="contact-link">
                info@pesasimigliori.com.ar
            </a>
        </p>
        <p>
            <strong>Horarios:</strong> Lunes a Viernes de 9:00 a 18:00 hs
        </p>
    </div>
</div>

<div id="tasacionModal" class="tasacion-modal">
    <div class="tasacion-modal-content">
        <span class="close-modal" id="closeTasacionModal">&times;</span>
        <h2 class="section-title">Solicitar Tasación</h2>
        <form id="tasacionForm" class="tasacion-form" autocomplete="off">
            <div class="tasacion-row">
                <input type="text" name="nombre" class="tasacion-input" placeholder="Nombre" required>
                <input type="text" name="apellido" class="tasacion-input" placeholder="Apellido" required>
            </div>
            <div class="tasacion-row">
                <input type="email" name="mail" class="tasacion-input" placeholder="Email" required>
            </div>
            <div class="tasacion-row">
                <select name="tipo" class="tasacion-input" required>
                    <option value="">Tipo de propiedad</option>
                    <option value="Casa">Casa</option>
                    <option value="Terreno">Terreno</option>
                    <option value="Departamento">Departamento</option>
                </select>
            </div>
            <div class="tasacion-row">
                <select name="operacion" class="tasacion-input" required>
                    <option value="">Operación</option>
                    <option value="Venta">Venta</option>
                    <option value="Alquiler">Alquiler</option>
                </select>
            </div>
            <div class="tasacion-row">
                <textarea name="descripcion" class="tasacion-input" rows="3" maxlength="250" placeholder="Descripción breve"></textarea>
            </div>
            <div class="tasacion-row">
                <input type="text" name="ubicacion" class="tasacion-input" placeholder="Ubicación (obligatorio)" required>
            </div>
            <div class="tasacion-row">
                <input type="text" name="maps" class="tasacion-input" placeholder="Enlace de Google Maps (opcional)">
            </div>
            <button type="submit" class="tasacion-btn">Enviar por WhatsApp</button>
        </form>
    </div>
</div>

<div id="whatsappModal" class="whatsapp-modal">
    <div class="whatsapp-modal-content">
        <span class="close-modal" id="closeWhatsappModal">&times;</span>
        <h2 class="section-title">Consulta por WhatsApp</h2>
        <form id="whatsappForm" class="whatsapp-form" autocomplete="off">
            <div class="whatsapp-row">
                <input type="number" min="1" name="habitaciones" class="whatsapp-input" placeholder="Cantidad de habitaciones">
            </div>
            <div class="whatsapp-row">
                <input type="text" name="ubicacion_aprox" class="whatsapp-input" placeholder="Ubicación aproximada">
            </div>
            <div class="whatsapp-row">
                <input type="number" min="1" name="personas" class="whatsapp-input" placeholder="Cantidad de personas">
            </div>
            <div class="whatsapp-row">
                <select name="operacion" class="whatsapp-input">
                    <option value="">Operación (opcional)</option>
                    <option value="Venta">Venta</option>
                    <option value="Alquiler">Alquiler</option>
                </select>
            </div>
            <button type="submit" class="whatsapp-btn">Enviar por WhatsApp</button>
        </form>
        <p class="whatsapp-note">Todos los datos son opcionales.</p>
    </div>
</div>

    <script>
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('show');
        }
    </script>
    <script>
    document.getElementById('contactBtn').onclick = function(e) {
        e.preventDefault();
        document.getElementById('contactModal').classList.add('show');
    };
    document.getElementById('closeContactModal').onclick = function() {
        document.getElementById('contactModal').classList.remove('show');
    };
    document.getElementById('contactModal').onclick = function(e) {
        if (e.target === this) this.classList.remove('show');
    };
</script><script>
    document.getElementById('tasacionBtn').onclick = function(e) {
        e.preventDefault();
        document.getElementById('tasacionModal').classList.add('show');
    };
    document.getElementById('closeTasacionModal').onclick = function() {
        document.getElementById('tasacionModal').classList.remove('show');
    };
    document.getElementById('tasacionModal').onclick = function(e) {
        if (e.target === this) this.classList.remove('show');
    };
    document.getElementById('tasacionForm').onsubmit = function(e) {
        e.preventDefault();
        const nombre = this.nombre.value.trim();
        const apellido = this.apellido.value.trim();
        const mail = this.mail.value.trim();
        const tipo = this.tipo.value;
        const operacion = this.operacion.value;
        const descripcion = this.descripcion.value.trim();
        const ubicacion = this.ubicacion.value.trim();
        const maps = this.maps.value.trim();

        let mensaje = `Hola, quiero solicitar una tasación.\n\n`;
        mensaje += `Nombre: ${nombre}\nApellido: ${apellido}\nEmail: ${mail}\n`;
        mensaje += `Tipo de propiedad: ${tipo}\n`;
        mensaje += `Operación: ${operacion}\n`;
        if (descripcion) mensaje += `Descripción: ${descripcion}\n`;
        mensaje += `Ubicación: ${ubicacion}\n`;
        if (maps) mensaje += `Google Maps: ${maps}\n`;

        const url = `https://wa.me/3543511948?text=${encodeURIComponent(mensaje)}`;
        window.open(url, '_blank');
    };
</script><script>
    document.getElementById('whatsappBtn').onclick = function(e) {
        e.preventDefault();
        document.getElementById('whatsappModal').classList.add('show');
    };
    document.getElementById('closeWhatsappModal').onclick = function() {
        document.getElementById('whatsappModal').classList.remove('show');
    };
    document.getElementById('whatsappModal').onclick = function(e) {
        if (e.target === this) this.classList.remove('show');
    };
    document.getElementById('whatsappForm').onsubmit = function(e) {
        e.preventDefault();
        const habitaciones = this.habitaciones.value.trim();
        const ubicacion_aprox = this.ubicacion_aprox.value.trim();
        const personas = this.personas.value.trim();
        const operacion = this.operacion.value;

        let mensaje = "";
        if (habitaciones || ubicacion_aprox || personas || operacion) {
            mensaje = "Consulta por WhatsApp:\nHola me gustaría consultar por las propiedades disponibles con las siguientes características:\n";
            if (operacion) mensaje += `Operación: ${operacion}\n`;
            if (habitaciones) mensaje += `Habitaciones: ${habitaciones}\n`;
            if (ubicacion_aprox) mensaje += `Ubicación aproximada: ${ubicacion_aprox}\n`;
            if (personas) mensaje += `Cantidad de personas: ${personas}\n`;
        } else {
            mensaje = "Hola, me gustaría recibir información sobre las propiedades disponibles";
        }

        const url = `https://wa.me/3543511948?text=${encodeURIComponent(mensaje)}`;
        window.open(url, '_blank');
        document.getElementById('whatsappModal').classList.remove('show');
    };
</script>
</body>
</html>
